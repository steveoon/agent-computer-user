appId: com.huajuan.recruitment-assistant
productName: 花卷-Huajuan
copyright: Copyright 2025 Huajuan

# ASAR disabled: Next.js standalone has dynamic require() calls that don't work in ASAR archives
# Error: Cannot find module './cjs/react.development.js' when asar: true
# Size reduction is achieved through files exclusion rules instead
asar: false

# Build directories
directories:
  output: dist
  buildResources: resources

# Files to include in the package
# Note: .next/static and public are copied into .next/standalone by electron:build script
files:
  - build                              # Compiled Electron code
  - ".next/standalone/**/*"            # Next.js standalone build (includes static & public)
  - "!.next/standalone/**/node_modules/electron"
  - configs/agent-templates.json       # Template configs (readonly)

  # MCP dependencies - only include what's needed
  # pnpm stores deps in .pnpm, so we need to include them explicitly
  - node_modules/@playwright/mcp/**/*
  - node_modules/@modelcontextprotocol/sdk/**/*
  - node_modules/.pnpm/@playwright+mcp*/**/*
  - node_modules/.pnpm/@modelcontextprotocol+sdk@*/**/*
  # Only playwright-core is needed for MCP, not the full playwright package
  - node_modules/.pnpm/playwright-core@*/**/*

  # === Global exclusions to reduce package size ===
  # Source maps (not needed in production)
  - "!**/*.map"
  - "!**/*.map.js"
  # TypeScript declaration files
  - "!**/*.d.ts"
  - "!**/*.d.mts"
  # Test files
  - "!**/__tests__/**"
  - "!**/*.test.*"
  - "!**/*.spec.*"
  # Documentation
  - "!**/README.md"
  - "!**/CHANGELOG.md"
  - "!**/LICENSE"

# Extra resources to copy (outside asar)
extraResources:
  - from: configs/agent-templates.json
    to: configs/agent-templates.json
  # Environment files for multi-agent runtime
  # These will be copied to each agent's runtime directory
  - from: .env
    to: .env
    filter:
      - "**/*"
  - from: .env.local
    to: .env.local
    filter:
      - "**/*"
  - from: .env.production
    to: .env.production
    filter:
      - "**/*"

# Icon configuration
# electron-builder will look for:
# - mac: resources/icons/icon.icns
# - win: resources/icons/icon.ico
# - linux: resources/icons/icon.png
icon: resources/icons/icon

# macOS configuration
mac:
  category: public.app-category.business
  icon: resources/icons/icon.icns
  target:
    - target: dir
      arch:
        - arm64
        - x64
    - target: dmg
      arch:
        - arm64
        - x64
  hardenedRuntime: false
  gatekeeperAssess: false
  entitlements: resources/entitlements.mac.plist
  entitlementsInherit: resources/entitlements.mac.plist
  notarize: false
  # Exclude other platforms' native modules
  files:
    - "!**/*-win32-*/**"
    - "!**/*-linux-*/**"
    - "!**/win32-*/**"
    - "!**/linux-*/**"

# DMG configuration
dmg:
  contents:
    - x: 130
      y: 220
    - x: 410
      y: 220
      type: link
      path: /Applications
  window:
    width: 540
    height: 380

# Windows configuration
win:
  icon: resources/icons/icon.ico
  target:
    - target: nsis
      arch:
        - x64
    - target: portable
      arch:
        - x64
  # Code signing disabled by not providing cscLink
  # Exclude other platforms' native modules to reduce package size
  # This is critical for NSIS which has a ~200MB memory limit
  files:
    - "!**/*-darwin-*/**"
    - "!**/*-linux-*/**"
    - "!**/darwin-*/**"
    - "!**/linux-*/**"
    - "!**/fsevents/**"

# NSIS installer configuration (Windows)
nsis:
  oneClick: false
  perMachine: true
  allowToChangeInstallationDirectory: true
  createDesktopShortcut: true
  createStartMenuShortcut: true

# Linux configuration (optional)
linux:
  icon: resources/icons
  target:
    - AppImage
    - deb
  category: Office
  # Exclude other platforms' native modules
  files:
    - "!**/*-darwin-*/**"
    - "!**/*-win32-*/**"
    - "!**/darwin-*/**"
    - "!**/win32-*/**"
    - "!**/fsevents/**"
